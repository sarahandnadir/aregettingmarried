:root{
  /* color system */
  --bg: #f9f9f8;         /* soft page background */
  --paper: #faf8ed;      /* inner letter paper */
  --envelope: #ffffff;   /* envelope white */
  --ink: rgba(0,0,0,.88);
  --ink-soft: rgba(0,0,0,.7);
  --line: rgba(0,0,0,.08);
  --shadow-1: 0 20px 60px rgba(0,0,0,.12);
  --shadow-2: 0 6px 16px rgba(0,0,0,.06);

  /* sizing */
  --letter-w: min(820px, 90vw);
  --letter-h: min(1080px, 120vh); /* roomy interior area */
  --flap-h: 180px;
  --thick: 2px;
}

/* reset */
* { box-sizing: border-box; }
html, body { height:100%; margin:0; }
body {
  background:
    radial-gradient(1000px 700px at 50% 35%, #ffffff 0%, #fbfbfb 40%, var(--bg) 100%);
  color: var(--ink);
  -webkit-font-smoothing: antialiased;
  font-family: "helvetica-neue","Helvetica Neue","Neue Haas Grotesk Text","Neue Haas Grotesk Display", Helvetica, Arial, ui-sans-serif, system-ui, -apple-system, "Segoe UI", sans-serif;
}

/* hint */
#hint{
  position: fixed;
  left: 50%;
  bottom: 16px;
  transform: translateX(-50%);
  background: rgba(255,255,255,.8);
  border: 1px solid var(--line);
  border-radius: 999px;
  padding: 8px 14px;
  font-size: 13px;
  color: var(--ink-soft);
  box-shadow: var(--shadow-2);
  z-index: 10;
  animation: hintFade 5s 1 1.2s forwards;
}
@keyframes hintFade { to { opacity: 0; visibility: hidden; } }

/* stage centers & handles zoom */
#stage{
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  overflow: hidden;
}
#zoom-layer{
  transform: translateZ(0) scale(1);
  transform-origin: center center;
  transition: transform .12s ease-out;
  will-change: transform;
}

/* Envelope 3D container */
.envelope{
  width: calc(var(--letter-w) + 80px);
  height: calc(var(--letter-h) + var(--flap-h));
  position: relative;
  perspective: 1600px;
}

/* back */
.env-back{
  position: absolute; inset: calc(var(--flap-h) - 2px) 40px 40px 40px;
  background: var(--envelope);
  border: var(--thick) solid #fff;
  border-radius: 14px;
  box-shadow: var(--shadow-1);
}

/* pocket (front lower) */
.env-pocket{
  position: absolute; inset: calc(var(--flap-h) + 10px) 40px 40px 40px;
  background: var(--envelope);
  border: var(--thick) solid #fff;
  border-radius: 14px;
  box-shadow: var(--shadow-2);
  z-index: 2;
}

/* flap */
.env-flap{
  position: absolute;
  height: var(--flap-h);
  left: 40px; right: 40px; top: 40px;
  background: var(--envelope);
  border: var(--thick) solid #fff;
  border-bottom: none;
  border-top-left-radius: 14px;
  border-top-right-radius: 14px;
  transform-origin: top center;
  transform: rotateX(0deg);
  box-shadow: var(--shadow-2);
  z-index: 3;
  transition: transform .9s cubic-bezier(.22,.61,.21,1), box-shadow .9s;
}

/* letter */
.letter{
  position: absolute;
  left: 60px; right: 60px;
  top: calc(var(--flap-h) + 40px);
  bottom: 60px;
  z-index: 1;
  display: grid;
  grid-template-rows: auto 1fr;
  border-radius: 10px;
  overflow: hidden;
  transform: translateY(0);
  transition: transform .9s cubic-bezier(.22,.61,.21,1);
}

/* front cover area (visible pre-open) */
.letter-front{
  display: grid;
  place-items: center;
  background: var(--paper);
  border: var(--thick) solid #fff;
  border-radius: 10px 10px 0 0;
  height: 220px;
}
.cover-title{
  font-weight: 700;
  font-size: clamp(22px, 3.8vw, 38px);
  letter-spacing: -0.02em;
}

/* inside (site) */
.letter-inside{
  background: var(--paper);
  border: var(--thick) solid #fff;
  border-top: none;
  border-radius: 0 0 10px 10px;
  overflow: auto;
}
.site{
  padding: 24px 26px 28px 20px;
  max-width: 760px;
  margin-inline: auto;

  /* subtle paper grain */
  background-image: radial-gradient(rgba(0,0,0,0.02) 1px, transparent 1px);
  background-size: 6px 6px;
}

/* site typography */
.site-head h1{
  margin: 0 0 .2rem 0;
  font-weight: 700;
  font-size: clamp(20px, 3vw, 30px);
  letter-spacing: -0.02em;
}
.sub{ margin: 0 0 .8rem 0; color: var(--ink-soft); }

.site-block{ margin: 1rem 0 1.1rem; }
.site-block h2{
  margin: 0 0 .4rem 0;
  font-size: 16px; font-weight: 700;
  letter-spacing: .01em;
}
.site p{ margin: .4rem 0; line-height: 1.55; font-size: 16px; }
.caption{ font-size: 13px; line-height: 1.35; color: var(--ink-soft); }

.timeline{ list-style: none; padding: 0; margin: .4rem 0 0; }
.timeline li{ padding: .18rem 0; display: grid; grid-template-columns: 140px 1fr; gap: .8rem; }
.timeline li span{ font-weight: 700; }

/* OPEN STATE */
.envelope.open .env-flap{
  transform: rotateX(-178deg);
  box-shadow: 0 12px 40px rgba(0,0,0,.10);
}
.envelope.open .letter{
  transform: translateY(-140px);
}

/* responsive */
@media (max-width: 780px){
  :root{ --flap-h: 150px; }
  .timeline li{ grid-template-columns: 120px 1fr; }
}
